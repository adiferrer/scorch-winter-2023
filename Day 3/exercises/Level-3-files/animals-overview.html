<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animals Overview</title>
    <!--Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <style>
        html {
            min-height: 100%;
            position: relative;
        }

        body {
            height: 100%;
        }

        .background {
            height: 100%;
            position: absolute;
            display: block;
            top: 0;
            left: 0;
            z-index: -1;
        }

        .nav,
        .nav-link,
        .nav-link:hover {
            border: 0 !important;
        }

        .nav-link {
            color: #000 !important;
        }

        .nav-link:hover,
        .nav-link.active {
            color: #6c757d !important;
        }

        #animals-container {
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .img-fluid.rounded-start {
            width: 100%;
            height: 24vh;
            object-fit: cover;
            object-position: center;
        }

        @media screen and (max-width: 768px) {
            .container .card {
                width: 100%;
            }
        }

        @media only screen and (min-width: 768px) {
            .container .card {
                width: 50%;
            }
        }

        @media only screen and (min-width: 992px) {
            .container .card {
                width: 33%;
            }
        }
    </style>
</head>

<body>
    <canvas class="background"></canvas>

    <!-- Start of Navbar-->
    <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
        <div class="container-fluid">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="container collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav me-auto mb-2 mb-md-0">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="animals-overview.html">Animals</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="submit-animal.html">Submit an Animal</a>
                    </li>
                </ul>
                <form class="d-flex" role="search">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"
                        id="animal-search">
                </form>
            </div>
        </div>
    </nav>
    <!-- End of Navbar-->

    <div class="container my-5 d-flex" id="animals-container">
    </div>

</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.0.1/js/bootstrap.min.js"
    integrity="sha512-EKWWs1ZcA2ZY9lbLISPz8aGR2+L7JVYqBAYTq5AXgBkSjRSuQEGqWx8R1zAX16KdXPaCjOCaKE8MCpU0wcHlHA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/particlesjs/2.2.2/particles.min.js"></script>
<script src="https://unpkg.com/lunr/lunr.js"></script>
<script>
    window.onload = function () {
        if (document.querySelector('.background') !== null) {
            Particles.init({
                selector: '.background',
                maxParticles: 210,
                connectParticles: true
            });
        }
    };

    if (JSON.parse(localStorage.getItem("animals")) === null) {
        localStorage.setItem("animals", JSON.stringify([
            {
                name: "Horseshoe Crab",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/horseshoe-crab.jpeg"
            },
            {
                name: "Lemur",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/lemur.jpeg",
            },
            {
                name: "Dolphin",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/dolphin.avif",
            },
            {
                name: "Deer",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/deer.jpeg",
            },
            {
                name: "Tiger",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/tiger.jpeg",
            },
            {
                name: "Parrot",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/parrot.png",
            },
            {
                name: "Otter",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/otter.jpeg",
            },
            {
                name: "Rhino",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/rhino.jpeg",
            },
            {
                name: "Owl",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/owl.jpeg",
            },
            {
                name: "Elephant",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/elephant.webp",
            },
            {
                name: "Jellyfish",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/jellyfish.jpeg",
            },
            {
                name: "Wolf",
                subtitle: "Species name",
                endangered: "Least Concern",
                image: "./images/wolf.jpeg",
            }
        ]));
    };

    let animals = JSON.parse(localStorage.getItem("animals"));
    var idx = lunr(function () {
        this.ref('name')
        this.field('name')

        animals.forEach(function (a) {
            this.add(a)
        }, this)
    });

    const animalSearch = document.querySelector('#animal-search');
    animalSearch.addEventListener('keyup', (e) => {
        const searchValue = e.target.value;
        const searchResults = idx.search('name:' + searchValue + '*');
        const searchResultsNames = searchResults.map(result => result.ref);
        const searchResultsAnimals = animals.filter(animal => searchResultsNames.includes(animal.name));
        const animalsContainer = document.querySelector('#animals-container');
        animalsContainer.innerHTML = '';
        searchResultsAnimals.forEach(animal => {
            const animalCard = document.createElement('div');
            animalCard.classList.add('card', 'mb-3');
            animalCard.style.maxWidth = '540px';
            const animalRow = document.createElement('div');
            animalRow.classList.add('row', 'g-0');
            const animalImage = document.createElement('div');
            animalImage.classList.add('col-md-4');
            const animalImageTag = document.createElement('img');
            animalImageTag.src = animal.image;
            animalImageTag.classList.add('img-fluid', 'rounded-start');
            animalImage.appendChild(animalImageTag);
            const animalInfo = document.createElement('div');
            animalInfo.classList.add('col-md-8');
            const animalCardBody = document.createElement('div');
            animalCardBody.classList.add('card-body');
            const animalName = document.createElement('h5');
            animalName.classList.add('card-title');
            animalName.innerText = animal.name;
            const animalSubtitle = document.createElement('p');
            animalSubtitle.classList.add('card-text');
            animalSubtitle.innerText = animal.subtitle;
            const animalEndangered = document.createElement('p');
            animalEndangered.classList.add('card-text');
            const animalEndangeredTag = document.createElement('small');
            animalEndangeredTag.classList.add('text-muted');
            animalEndangeredTag.innerText = animal.endangered;
            animalEndangered.appendChild(animalEndangeredTag);
            const animalReadMore = document.createElement('a');
            animalReadMore.classList.add('btn', 'btn-dark');
            animalReadMore.href = `./animal-pages/${animal.name.toLowerCase().replace(' ', '-')}.html`;
            animalReadMore.innerText = 'Read More';
            animalCardBody.appendChild(animalName);
            animalCardBody.appendChild(animalSubtitle);
            animalCardBody.appendChild(animalEndangered);
            animalCardBody.appendChild(animalReadMore);
            animalInfo.appendChild(animalCardBody);
            animalRow.appendChild(animalImage);
            animalRow.appendChild(animalInfo);
            animalCard.appendChild(animalRow);
            animalsContainer.appendChild(animalCard);
        });
    });

    animals.forEach(animal => {
        const animalCard = document.createElement('div');
        animalCard.classList.add('card', 'mb-3');
        animalCard.style.maxWidth = '540px';
        const animalRow = document.createElement('div');
        animalRow.classList.add('row', 'g-0');
        const animalImage = document.createElement('div');
        animalImage.classList.add('col-md-4');
        const animalImageTag = document.createElement('img');
        animalImageTag.src = animal.image;
        animalImageTag.classList.add('img-fluid', 'rounded-start');
        animalImage.appendChild(animalImageTag);
        const animalInfo = document.createElement('div');
        animalInfo.classList.add('col-md-8');
        const animalCardBody = document.createElement('div');
        animalCardBody.classList.add('card-body');
        const animalName = document.createElement('h5');
        animalName.classList.add('card-title');
        animalName.innerText = animal.name;
        const animalSubtitle = document.createElement('p');
        animalSubtitle.classList.add('card-text');
        animalSubtitle.innerText = animal.subtitle;
        const animalEndangered = document.createElement('p');
        animalEndangered.classList.add('card-text');
        const animalEndangeredTag = document.createElement('small');
        animalEndangeredTag.classList.add('text-muted');
        animalEndangeredTag.innerText = animal.endangered;
        animalEndangered.appendChild(animalEndangeredTag);
        const animalReadMore = document.createElement('a');
        animalReadMore.classList.add('btn', 'btn-dark');
        animalReadMore.href = `./animal-pages/${animal.name.toLowerCase().replace(' ', '-')}.html`;
        animalReadMore.innerText = 'Read More';
        animalCardBody.appendChild(animalName);
        animalCardBody.appendChild(animalSubtitle);
        animalCardBody.appendChild(animalEndangered);
        animalCardBody.appendChild(animalReadMore);
        animalInfo.appendChild(animalCardBody);
        animalRow.appendChild(animalImage);
        animalRow.appendChild(animalInfo);
        animalCard.appendChild(animalRow);
        document.querySelector('#animals-container').appendChild(animalCard);
    })
</script>

</html>